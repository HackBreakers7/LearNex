{% load static %}

<!DOCTYPE html>
<!--
Template Name: NobleUI - HTML Bootstrap 5 Admin Dashboard Template
Author: NobleUI
Website: https://www.nobleui.com
Portfolio: https://themeforest.net/user/nobleui/portfolio
Contact: nobleui123@gmail.com
Purchase: https://1.envato.market/nobleui_admin
License: For each use you must have a valid license purchased only from above link in order to legally use the theme for your project.
-->
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="Responsive HTML Admin Dashboard Template based on Bootstrap 5">
    <meta name="author" content="NobleUI">
    <meta name="keywords"
      content="nobleui, bootstrap, bootstrap 5, bootstrap5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

    <title>Learn Nex</title>

    <!-- color-modes:js -->
    <script src="{% static 'assets/js/color-modes.js' %}"></script>
    <!-- endinject -->

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="../../../../../css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- End fonts -->

    <!-- core:css -->
    <link rel="stylesheet" href="{% static 'assets/vendors/core/core.css' %}">
    <!-- endinject -->

    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->

    <!-- inject:css -->
    <link rel="stylesheet" href="{% static 'assets/fonts/feather-font/css/iconfont.css' %}">
    <!-- endinject -->

    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static 'assets/css/demo1/style.css' %}">
    <!-- End layout styles -->

    <link rel="shortcut icon" href="{% static 'assets/images/favicon.png' %}">

    <style>
      .table-container {
        padding: 20px;
      }

      .table th,
      .table td {
        text-align: center;
      }

      .table {
        width: 100%;
        margin-bottom: 1rem;
        color: #212529;
        border-collapse: collapse;
      }

      .table thead th {
        vertical-align: bottom;
        border-bottom: 2px solid #dee2e6;
      }

      .table tbody+tbody {
        border-top: 2px solid #dee2e6;
      }

      .table .table {
        background-color: #fff;
      }

      .table-bordered {
        border: 1px solid #dee2e6;
      }

      .table-bordered th,
      .table-bordered td {
        border: 1px solid #dee2e6;
      }

    </style>
  </head>

  <body>
    <div class="main-wrapper">
      <div class="page-wrapper full-page">
        <div class="page-content d-flex align-items-center justify-content-center">
          <div class="row w-100 mx-0 auth-page">
            <div class="col-md-12 col-lg-10 mx-auto">
              <div class="card">
                <div class="auth-form-wrapper px-4 py-5">
                  <!-- Image at the top -->

                  <!-- Heading in the center -->
                  <h3 class="text-center mb-4">Register</h3>
                  <h5 class="text-secondary text-center fw-normal mb-4">Create a free account.</h5>
                  <!-- Registration form -->
<form class="forms-sample" method="POST" enctype="multipart/form-data" id="registrationForm">
  {% csrf_token %}
  <h4 class="mb-3">Parent/Guardian Details</h4>
  <div class="row mb-3">
    <div class="col-md-4 mb-3">
      <label for="parent_first_name" class="form-label">First Name</label>
      <input type="text" class="form-control" id="parent_first_name" name="parent_first_name" placeholder="First Name">
    </div>
    <div class="col-md-4 mb-3">
      <label for="parent_middle_name" class="form-label">Middle Name</label>
      <input type="text" class="form-control" id="parent_middle_name" name="parent_middle_name"
        placeholder="Middle Name">
    </div>
    <div class="col-md-4 mb-3">
      <label for="parent_last_name" class="form-label">Last Name</label>
      <input type="text" class="form-control" id="parent_last_name" name="parent_last_name" placeholder="Last Name">
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-6 mb-3">
      <label for="parent_dob" class="form-label">Date of Birth</label>
      <input type="date" class="form-control" id="parent_dob" name="parent_dob">
    </div>
    <div class="col-md-6 mb-3">
      <label for="parent_gender" class="form-label">Gender</label>
      <select class="form-select" id="parent_gender" name="parent_gender">
        <option value="" selected disabled>Select Gender</option>
        <option value="male">Male</option>
        <option value="female">Female</option>
        <option value="other">Other</option>
      </select>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-6 mb-3">
      <label for="parent_email" class="form-label">Email address</label>
      <input type="email" class="form-control" id="parent_email" name="parent_email" placeholder="Email address">
    </div>
    <div class="col-md-6 mb-3">
      <label for="parent_contact_number" class="form-label">Contact Number</label>
      <input type="tel" class="form-control" id="parent_contact_number" name="parent_contact_number"
        placeholder="Contact Number">
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-4 mb-3">
      <label for="username" class="form-label">Username</label>
      <input type="text" class="form-control" id="username" name="username" placeholder="Username">
    </div>
    <div class="col-md-4 mb-3">
      <label for="password" class="form-label">Password</label>
      <input type="password" class="form-control" id="password" name="password" placeholder="Password">
    </div>
    <div class="col-md-4 mb-3">
      <label for="confirm_password" class="form-label">Confirm Password</label>
      <input type="password" class="form-control" id="confirm_password" name="confirm_password"
        placeholder="Confirm Password">
    </div>
  </div>
  <!-- Child Details Section -->
  <h4 class="mb-3">Child Details</h4>
  <div class="row mb-3">
    <div class="col-md-4 mb-3">
      <label for="child_first_name" class="form-label">First Name</label>
      <input type="text" class="form-control" id="child_first_name" name="child_first_name" placeholder="First Name">
    </div>
    <div class="col-md-4 mb-3">
      <label for="child_middle_name" class="form-label">Middle Name</label>
      <input type="text" class="form-control" id="child_middle_name" name="child_middle_name" placeholder="Middle Name">
    </div>
    <div class="col-md-4 mb-3">
      <label for="child_last_name" class="form-label">Last Name</label>
      <input type="text" class="form-control" id="child_last_name" name="child_last_name" placeholder="Last Name">
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-md-6 mb-3">
      <label for="child_dob" class="form-label">Date of Birth</label>
      <input type="date" class="form-control" id="child_dob" name="child_dob">
    </div>
    <div class="col-md-6 mb-3">
      <label for="child_gender" class="form-label">Gender</label>
      <select class="form-select" id="child_gender" name="child_gender">
        <option value="" selected disabled>Select Gender</option>
        <option value="male">Male</option>
        <option value="female">Female</option>
        <option value="other">Other</option>
      </select>
    </div>
  </div>
  <!-- School Details -->
  <h4 class="mb-3">School Details</h4>
  <div class="row mb-3">
    <div class="col-md-6 mb-3">
      <label for="school_name" class="form-label">School Name</label>
      <input type="text" class="form-control" id="school_name" name="school_name" placeholder="School Name">
    </div>
    <div class="col-md-6 mb-3">
      <label for="school_medium" class="form-label">Medium of Education</label>
      <select class="form-select" id="school_medium" name="school_medium">
        <option value="" selected disabled>Select Medium</option>
        <option value="english">English</option>
        <option value="marathi">Marathi</option>
        <option value="hindi">Hindi</option>
        <option value="other">Other</option>
      </select>
    </div>
  </div>
  <!-- Additional Information -->
  <h4 class="mb-3">Additional Information</h4>
  <div class="mb-3">
    <label for="hobbies" class="form-label">Hobbies</label>
    <input type="text" class="form-control" id="hobbies" name="hobbies" placeholder="Hobbies (comma separated)">
  </div>
  <div class="mb-3">
    <label for="address" class="form-label">Address</label>
    <textarea class="form-control" id="address" name="address" rows="2" placeholder="Address"></textarea>
  </div>
  <!-- File Upload -->
  <div class="mb-3">
    <label for="document_upload" class="form-label">Upload Adhar Card Image</label>
    <input type="file" class="form-control" id="document_upload" name="document_upload"
      accept=".pdf, .doc, .docx, .jpg, .jpeg, .png">
  </div>
  <!-- Submit Button -->
<div>
  <button type="submit" id="submit_button" class="btn btn-primary text-white me-2 mb-2 mb-md-0">Sign
    up</button>
</div>
  <a href="login.html" class="d-block mt-3 text-secondary">Already a user? Sign in</a>
</form>



                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const loginForm = document.getElementById('loginForm');
    const dashboardUrl = "{% url 'dashboard' %}";  // Generate URL using Django template tag

    loginForm.addEventListener('submit', function (event) {
      const username = document.getElementById('userUsername').value.trim();
      const password = document.getElementById('userPassword').value.trim();

      if (!username || !password) {
        alert('Both username and password are required.');
        event.preventDefault();
      }
    });

    // Handle the form submission manually to provide proper alerts
    loginForm.addEventListener('submit', function (event) {
      event.preventDefault();  // Prevent the default form submission

      const formData = new FormData(loginForm);

      fetch("{% url 'login' %}", {
        method: 'POST',
        body: formData,
        headers: {
          'X-Requested-With': 'XMLHttpRequest',  // Ensure Django's CSRF protection works
        }
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            window.location.href = dashboardUrl;  // Redirect to dashboard
          } else {
            alert(data.message);  // Show the error message
          }
        })
        .catch(error => {
          alert('An error occurred: ' + error);
        });
    });
  });
</script>

    <!-- core:js -->
    <script src="{% static 'assets/vendors/core/core.js' %}"></script>
    <!-- endinject -->

    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->

    <!-- inject:js -->
    <script src="{% static 'assets/vendors/feather-icons/feather.min.js' %}"></script>
    <script src="{% static 'assets/js/app.js' %}"></script>
    <!-- endinject -->

    <!-- Custom js for this page -->
    <!-- End custom js for this page -->
    <!-- <script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('generate_otp').addEventListener('click', async function () {
          const email = document.getElementById('parent_email').value;
          const response = await fetch('/register-user/', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({ parent_email: email })
          });

          const data = await response.json();
          if (data.status === 'success') {
            alert('OTP sent to your email.');
            document.getElementById('otp').disabled = false;
          } else {
            alert('Failed to send OTP.');
          }
        });

        document.getElementById('verify_otp').addEventListener('click', async function () {
          const email = document.getElementById('parent_email').value;
          const otp = document.getElementById('otp').value;

          const response = await fetch('/verify-otp/', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({ email, otp })
          });

          const data = await response.json();
          if (data.status === 'success') {
            alert('OTP verified successfully.');
            document.querySelector('.forms-sample').querySelector('button[type="submit"]').disabled = false;
          } else {
            alert('Invalid OTP.');
          }
        });

        document.querySelector('.forms-sample').addEventListener('submit', function (event) {
          event.preventDefault();

          const password = document.getElementById('password').value;
          const confirmPassword = document.getElementById('confirm_password').value;
          if (password !== confirmPassword) {
            alert('Passwords do not match.');
            return;
          }

          const parentDob = document.getElementById('parent_dob').value;
          const childDob = document.getElementById('child_dob').value;

          if (calculateAge(parentDob) < 20) {
            alert('Parent/Guardian must be at least 20 years old.');
            return;
          }

          if (calculateAge(childDob) < 0) {
            alert('Invalid child date of birth.');
            return;
          }

          event.target.submit();
        });
      });

    </script> -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Form and button references
    const registrationForm = document.getElementById('registrationForm');
    const submitButton = document.getElementById('submit_button');

    // Enable submit button only if all required fields are filled
    registrationForm.addEventListener('input', function () {
      const isValid = Array.from(registrationForm.elements).every(input => {
        if (input.type !== 'file') {
          return input.value.trim() !== '';
        }
        return true;
      });
      // submitButton.disabled = !isValid;
    });
  });
</script>

  </body>

</html>
